server:
  shutdown: graceful
  tomcat:
    threads:
      max: ${SERVER_TOMCAT_THREADS_MAX:400}
      min-spare: ${SERVER_TOMCAT_THREADS_MIN_SPARE:20}
    max-connections: ${SERVER_TOMCAT_MAX_CONNECTIONS:20000}
    accept-count: ${SERVER_TOMCAT_ACCEPT_COUNT:1000}

spring:
  main:
    allow-bean-definition-overriding: true
  cloud:
    nacos:
      discovery:
        server-addr: ${NACOS_SERVER_ADDR:${NACOS_HOST:127.0.0.1}:${NACOS_PORT:18848}}
        username: ${NACOS_USERNAME:nacos}
        password: ${NACOS_PASSWORD:nacos}
        namespace: ${NACOS_NAMESPACE:public}
        group: ${NACOS_GROUP:DEFAULT_GROUP}
        prefer-ip-address: ${NACOS_PREFER_IP_ADDRESS:true}
        ip: ${NACOS_INSTANCE_IP:}
        port: ${NACOS_INSTANCE_PORT:${server.port}}
        ephemeral: ${NACOS_EPHEMERAL:true}
        metadata:
          instance-id: ${SERVICE_INSTANCE_ID:${spring.application.name}:${random.uuid}}
          deploy-mode: ${SERVICE_DEPLOY_MODE:multi}
          traffic-role: ${SERVICE_TRAFFIC_ROLE:business}
          singleton: ${SERVICE_SINGLETON:false}
      config:
        server-addr: ${NACOS_SERVER_ADDR:${NACOS_HOST:127.0.0.1}:${NACOS_PORT:18848}}
        username: ${NACOS_USERNAME:nacos}
        password: ${NACOS_PASSWORD:nacos}
        namespace: ${NACOS_NAMESPACE:public}
        file-extension: yaml
        group: ${NACOS_GROUP:DEFAULT_GROUP}
    openfeign:
      client:
        config:
          default:
            connectTimeout: ${FEIGN_CONNECT_TIMEOUT:5000}
            readTimeout: ${FEIGN_READ_TIMEOUT:10000}
            loggerLevel: ${FEIGN_LOG_LEVEL:basic}
      compression:
        request:
          enabled: true
        response:
          enabled: true
    stream:
      rocketmq:
        binder:
          name-server: ${ROCKETMQ_NAME_SERVER:${ROCKETMQ_NAMESRV_HOST:127.0.0.1}:${ROCKETMQ_NAMESRV_PORT:19876}}
  config:
    import: optional:nacos:common
  datasource:
    driver-class-name: ${DB_DRIVER:com.mysql.cj.jdbc.Driver}
    username: ${DB_USERNAME:root}
    password: ${DB_PASSWORD:root}
    hikari:
      maximum-pool-size: ${DB_POOL_SIZE:20}
      minimum-idle: ${DB_MIN_IDLE:5}
      connection-timeout: ${DB_CONNECTION_TIMEOUT:30000}
      idle-timeout: ${DB_IDLE_TIMEOUT:600000}
      max-lifetime: ${DB_MAX_LIFETIME:1800000}
  data:
    redis:
      host: ${REDIS_HOST:127.0.0.1}
      port: ${REDIS_PORT:6379}
      password: ${REDIS_PASSWORD:root}
      timeout: ${REDIS_TIMEOUT:10000ms}
      lettuce:
        pool:
          max-active: ${REDIS_MAX_ACTIVE:50}
          max-wait: ${REDIS_MAX_WAIT:3000ms}
          max-idle: ${REDIS_MAX_IDLE:20}
          min-idle: ${REDIS_MIN_IDLE:5}
          time-between-eviction-runs: 60000
        shutdown-timeout: ${REDIS_SHUTDOWN_TIMEOUT:100ms}
logging:
  file:
    path: ${LOG_PATH:D:/logs}/${spring.application.name}
    name: ${logging.file.path}/${spring.application.name}.log
  level:
    com.cloud: ${LOG_LEVEL_CLOUD:info}
    org.springframework.security: ${LOG_LEVEL_SECURITY:warn}
    org.springframework.web: ${LOG_LEVEL_WEB:warn}
    org.springframework.cloud: ${LOG_LEVEL_CLOUD_FRAMEWORK:warn}
mybatis-plus:
  mapper-locations: classpath*:mapper/**/*.xml
  configuration:
    map-underscore-to-camel-case: true
    auto-mapping-behavior: full
    log-impl: ${MYBATIS_LOG_IMPL:org.apache.ibatis.logging.nop.NopImpl}
  global-config:
    enable-sql-runner: true
    db-config:
      id-type: assign_id
      logic-delete-field: deleted
      logic-not-delete-value: 0
      logic-delete-value: 1
      insert-strategy: not_null
      update-strategy: not_null
      select-strategy: not_empty
springdoc:
  api-docs:
    enabled: ${API_DOCS_ENABLED:true}
    path: /v3/api-docs
  swagger-ui:
    enabled: ${SWAGGER_UI_ENABLED:true}
    path: /swagger-ui.html
    tags-sorter: alpha
    operations-sorter: alpha
  default-flat-param-object: true
knife4j:
  enable: ${KNIFE4J_ENABLED:true}
  production: ${KNIFE4J_PRODUCTION:false}
  basic:
    enable: false
  setting:
    language: ZH_CN
    enable-version: true
    enable-swagger-models: true
    swagger-model-name: 閻庡湱鍋樼紞瀣尵鐠囨彃鐏欓悶?
    enable-footer-custom: true
    footer-custom-content: "Cloud 鐎甸偊鍠楀﹢鍥礉閳ユ娊鎸柛?API 闁哄倸娲﹂妴?
cache:
  multi-level: ${CACHE_MULTI_LEVEL:true}
  consistency-enabled: ${CACHE_CONSISTENCY_ENABLED:false}
  ttl:
    user: ${CACHE_TTL_USER:1800}
    product: ${CACHE_TTL_PRODUCT:2700}
    stock: ${CACHE_TTL_STOCK:300}
    order: ${CACHE_TTL_ORDER:900}
    payment: ${CACHE_TTL_PAYMENT:600}
    search: ${CACHE_TTL_SEARCH:1200}
    auth: ${CACHE_TTL_AUTH:3600}
cloud:
  distributed-lock:
    enabled: ${DISTRIBUTED_LOCK_ENABLED:true}
    default-wait-time: ${DISTRIBUTED_LOCK_WAIT_TIME:3}
    default-lease-time: ${DISTRIBUTED_LOCK_LEASE_TIME:10}
    key-prefix: ${DISTRIBUTED_LOCK_PREFIX:distributed-lock}
    monitor-enabled: ${DISTRIBUTED_LOCK_MONITOR:true}
    log-enabled: ${DISTRIBUTED_LOCK_LOG:true}
app:
  async:
    enabled: ${APP_ASYNC_ENABLED:true}
    common:
      monitoring-enabled: ${APP_ASYNC_MONITORING_ENABLED:true}
      monitoring-interval-seconds: ${APP_ASYNC_MONITORING_INTERVAL_SECONDS:30}
      task-decorator: ${APP_ASYNC_TASK_DECORATOR:true}
      log-slow-tasks: ${APP_ASYNC_LOG_SLOW_TASKS:true}
      slow-task-threshold-ms: ${APP_ASYNC_SLOW_TASK_THRESHOLD_MS:3000}
    executors:
      gatewayRouteExecutor:
        core-pool-size: ${ASYNC_GATEWAY_ROUTE_CORE:4}
        max-pool-size: ${ASYNC_GATEWAY_ROUTE_MAX:16}
        queue-capacity: ${ASYNC_GATEWAY_ROUTE_QUEUE:500}
        keep-alive-seconds: ${ASYNC_GATEWAY_ROUTE_KEEP_ALIVE:60}
        thread-name-prefix: ${ASYNC_GATEWAY_ROUTE_PREFIX:gateway-route-}
      searchQueryExecutor:
        core-pool-size: ${ASYNC_SEARCH_QUERY_CORE:4}
        max-pool-size: ${ASYNC_SEARCH_QUERY_MAX:16}
        queue-capacity: ${ASYNC_SEARCH_QUERY_QUEUE:500}
        keep-alive-seconds: ${ASYNC_SEARCH_QUERY_KEEP_ALIVE:60}
        thread-name-prefix: ${ASYNC_SEARCH_QUERY_PREFIX:search-query-}
      searchSuggestionExecutor:
        core-pool-size: ${ASYNC_SEARCH_SUGGEST_CORE:3}
        max-pool-size: ${ASYNC_SEARCH_SUGGEST_MAX:8}
        queue-capacity: ${ASYNC_SEARCH_SUGGEST_QUEUE:200}
        keep-alive-seconds: ${ASYNC_SEARCH_SUGGEST_KEEP_ALIVE:60}
        thread-name-prefix: ${ASYNC_SEARCH_SUGGEST_PREFIX:search-suggestion-}
      searchCacheExecutor:
        core-pool-size: ${ASYNC_SEARCH_CACHE_CORE:2}
        max-pool-size: ${ASYNC_SEARCH_CACHE_MAX:6}
        queue-capacity: ${ASYNC_SEARCH_CACHE_QUEUE:150}
        keep-alive-seconds: ${ASYNC_SEARCH_CACHE_KEEP_ALIVE:60}
        thread-name-prefix: ${ASYNC_SEARCH_CACHE_PREFIX:search-cache-}
      stockOperationExecutor:
        core-pool-size: ${ASYNC_STOCK_OPERATION_CORE:4}
        max-pool-size: ${ASYNC_STOCK_OPERATION_MAX:16}
        queue-capacity: ${ASYNC_STOCK_OPERATION_QUEUE:300}
        keep-alive-seconds: ${ASYNC_STOCK_OPERATION_KEEP_ALIVE:60}
        thread-name-prefix: ${ASYNC_STOCK_OPERATION_PREFIX:stock-operation-}
  deploy:
    # admin-service/log-service are singleton by default; others are multi-instance.
    singleton-services: ${APP_SINGLETON_SERVICES:admin-service,log-service}
  permission:
    enabled: ${PERMISSION_ENABLED:true}
    strict-mode: ${PERMISSION_STRICT_MODE:false}
  message:
    idempotent-enabled: ${MESSAGE_IDEMPOTENT_ENABLED:true}
    idempotent-expire-seconds: ${MESSAGE_IDEMPOTENT_EXPIRE_SECONDS:86400}
management:
  endpoints:
    web:
      exposure:
        include: ${ACTUATOR_ENDPOINTS:health,info,metrics,prometheus}
  endpoint:
    health:
      show-details: ${HEALTH_SHOW_DETAILS:when_authorized}
  metrics:
    export:
      prometheus:
        enabled: ${PROMETHEUS_ENABLED:true}






