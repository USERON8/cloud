import{A as e,D as t,Dt as n,F as r,I as i,J as a,M as o,R as s,b as c,f as l,it as u,o as d,ut as f}from"./_plugin-vue_export-helper-7ehu3f-T.js";import{Ct as p,I as m,X as h,Z as g,st as _}from"./css-DepZNlzm.js";import{i as v}from"./css-BaDt1NEF.js";import{a as y,r as b}from"./message-CA9T8QLS.js";var x=h({to:{type:g([String,Object]),required:!0},disabled:Boolean}),S=m(c({__name:`teleport`,props:x,setup(e){return(e,t)=>e.disabled?s(e.$slots,`default`,{key:0}):(r(),l(d,{key:1,to:e.to},[s(e.$slots,`default`)],8,[`to`]))}})),C=e=>_?window.requestAnimationFrame(e):setTimeout(e,16),w,ee=e=>{var t;if(!_)return 0;if(w!==void 0)return w;let n=document.createElement(`div`);n.className=`${e}-scrollbar__wrap`,n.style.visibility=`hidden`,n.style.width=`100px`,n.style.position=`absolute`,n.style.top=`-9999px`,document.body.appendChild(n);let r=n.offsetWidth;n.style.overflow=`scroll`;let i=document.createElement(`div`);i.style.width=`100%`,n.appendChild(i);let a=i.offsetWidth;return(t=n.parentNode)==null||t.removeChild(n),w=r-a,w};function te(e,t){if(!_)return;if(!t){e.scrollTop=0;return}let n=[],r=t.offsetParent;for(;r!==null&&e!==r&&e.contains(r);)n.push(r),r=r.offsetParent;let i=t.offsetTop+n.reduce((e,t)=>e+t.offsetTop,0),a=i+t.offsetHeight,o=e.scrollTop,s=o+e.clientHeight;i<o?e.scrollTop=i:a>s&&(e.scrollTop=a-e.clientHeight)}var T=`focus-trap.focus-after-trapped`,E=`focus-trap.focus-after-released`,D=`focus-trap.focusout-prevented`,O={cancelable:!0,bubbles:!1},k={cancelable:!0,bubbles:!1},A=`focusAfterTrapped`,j=`focusAfterReleased`,M=Symbol(`elFocusTrap`),N=u(),P=u(0),F=u(0),I=0,L=e=>{let t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{let t=e.tagName===`INPUT`&&e.type===`hidden`;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0||e===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t},R=(e,t)=>{for(let n of e)if(!z(n,t))return n},z=(e,t)=>{if(getComputedStyle(e).visibility===`hidden`)return!0;for(;e;){if(t&&e===t)return!1;if(getComputedStyle(e).display===`none`)return!0;e=e.parentElement}return!1},B=e=>{let t=L(e);return[R(t,e),R(t.reverse(),e)]},V=e=>e instanceof HTMLInputElement&&`select`in e,H=(e,t)=>{if(e){let n=document.activeElement;v(e,{preventScroll:!0}),F.value=window.performance.now(),e!==n&&V(e)&&t&&e.select()}};function U(e,t){let n=[...e],r=e.indexOf(t);return r!==-1&&n.splice(r,1),n}var W=()=>{let e=[];return{push:t=>{let n=e[0];n&&t!==n&&n.pause(),e=U(e,t),e.unshift(t)},remove:t=>{var n,r;e=U(e,t),(r=(n=e[0])==null?void 0:n.resume)==null||r.call(n)}}},G=(e,t=!1)=>{let n=document.activeElement;for(let r of e)if(H(r,t),document.activeElement!==n)return},K=W(),q=()=>P.value>F.value,J=()=>{N.value=`pointer`,P.value=window.performance.now()},Y=()=>{N.value=`keyboard`,P.value=window.performance.now()},ne=()=>(o(()=>{I===0&&(document.addEventListener(`mousedown`,J),document.addEventListener(`touchstart`,J),document.addEventListener(`keydown`,Y)),I++}),e(()=>{I--,I<=0&&(document.removeEventListener(`mousedown`,J),document.removeEventListener(`touchstart`,J),document.removeEventListener(`keydown`,Y))}),{focusReason:N,lastUserFocusTimestamp:P,lastAutomatedFocusTimestamp:F}),X=e=>new CustomEvent(D,{...k,detail:e}),Z=[],Q=e=>{b(e)===y.esc&&Z.forEach(t=>t(e))},re=t=>{o(()=>{Z.length===0&&document.addEventListener(`keydown`,Q),_&&Z.push(t)}),e(()=>{Z=Z.filter(e=>e!==t),Z.length===0&&_&&document.removeEventListener(`keydown`,Q)})},ie=c({name:`ElFocusTrap`,inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:`first`}},emits:[A,j,`focusin`,`focusout`,`focusout-prevented`,`release-requested`],setup(r,{emit:s}){let c=u(),l,d,{focusReason:m}=ne();re(e=>{r.trapped&&!h.paused&&s(`release-requested`,e)});let h={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},g=e=>{if(!r.loop&&!r.trapped||h.paused)return;let{altKey:t,ctrlKey:n,metaKey:i,currentTarget:a,shiftKey:o}=e,{loop:c}=r,l=b(e)===y.tab&&!t&&!n&&!i,u=document.activeElement;if(l&&u){let t=a,[n,r]=B(t);if(!(n&&r)){if(u===t){let t=X({focusReason:m.value});s(`focusout-prevented`,t),t.defaultPrevented||e.preventDefault()}}else if(!o&&u===r){let t=X({focusReason:m.value});s(`focusout-prevented`,t),t.defaultPrevented||(e.preventDefault(),c&&H(n,!0))}else if(o&&[n,t].includes(u)){let t=X({focusReason:m.value});s(`focusout-prevented`,t),t.defaultPrevented||(e.preventDefault(),c&&H(r,!0))}}};i(M,{focusTrapRef:c,onKeydown:g}),a(()=>r.focusTrapEl,e=>{e&&(c.value=e)},{immediate:!0}),a([c],([e],[t])=>{e&&(e.addEventListener(`keydown`,g),e.addEventListener(`focusin`,x),e.addEventListener(`focusout`,S)),t&&(t.removeEventListener(`keydown`,g),t.removeEventListener(`focusin`,x),t.removeEventListener(`focusout`,S))});let _=e=>{s(A,e)},v=e=>s(j,e),x=e=>{let t=f(c);if(!t)return;let n=e.target,i=e.relatedTarget,a=n&&t.contains(n);r.trapped||i&&t.contains(i)||(l=i),a&&s(`focusin`,e),!h.paused&&r.trapped&&(a?d=n:H(d,!0))},S=e=>{let t=f(c);if(!(h.paused||!t))if(r.trapped){let n=e.relatedTarget;!p(n)&&!t.contains(n)&&setTimeout(()=>{if(!h.paused&&r.trapped){let e=X({focusReason:m.value});s(`focusout-prevented`,e),e.defaultPrevented||H(d,!0)}},0)}else{let n=e.target;n&&t.contains(n)||s(`focusout`,e)}};async function C(){await t();let e=f(c);if(e){K.push(h);let i=e.contains(document.activeElement)?l:document.activeElement;if(l=i,!e.contains(i)){let a=new Event(T,O);e.addEventListener(T,_),e.dispatchEvent(a),a.defaultPrevented||t(()=>{let t=r.focusStartEl;n(t)||(H(t),document.activeElement!==t&&(t=`first`)),t===`first`&&G(L(e),!0),(document.activeElement===i||t===`container`)&&H(e)})}}}function w(){let e=f(c);if(e){e.removeEventListener(T,_);let t=new CustomEvent(E,{...O,detail:{focusReason:m.value}});e.addEventListener(E,v),e.dispatchEvent(t),!t.defaultPrevented&&(m.value==`keyboard`||!q()||e.contains(document.activeElement))&&H(l==null?document.body:l),e.removeEventListener(E,v),K.remove(h),l=null,d=null}}return o(()=>{r.trapped&&C(),a(()=>r.trapped,e=>{e?C():w()})}),e(()=>{r.trapped&&w(),c.value&&(c.value.removeEventListener(`keydown`,g),c.value.removeEventListener(`focusin`,x),c.value.removeEventListener(`focusout`,S),c.value=void 0),l=null,d=null}),{onKeydown:g}}}),$=(e,t)=>{let n=e.__vccOpts||e;for(let[e,r]of t)n[e]=r;return n};function ae(e,t,n,r,i,a){return s(e.$slots,`default`,{handleKeydown:e.onKeydown})}var oe=$(ie,[[`render`,ae]]);export{te as a,x as c,ee as i,$ as n,C as o,M as r,S as s,oe as t};