import{F as e,J as t,L as n,Nt as r,X as i,a,b as o,d as s,f as c,it as l,jt as u,m as d,t as f,u as p,v as m,y as h,z as g}from"./_plugin-vue_export-helper-7ehu3f-T.js";import{r as _,s as v}from"./http-BtjM28wp.js";import{n as y,r as b,t as x}from"./index-D_UHLrTq.js";import{t as S}from"./css-DepZNlzm.js";import{t as C}from"./message-CA9T8QLS.js";import{n as ee}from"./auth-VUrFAAGG.js";var te={class:`app-shell`},w={class:`desktop-nav glass-card`},T={class:`nav-icon`,"aria-hidden":`true`},E={viewBox:`0 0 24 24`,fill:`none`},D=[`d`],O={class:`nav-label`},k={class:`main-panel`},A={class:`top-bar glass-card`},j={class:`top-actions`},M=[`src`],N={class:`role-chip`},P={class:`user-chip`},F={class:`content`},I={class:`mobile-tab glass-card`},L={class:`nav-icon`,"aria-hidden":`true`},R={viewBox:`0 0 24 24`,fill:`none`},z=[`d`],B=f(o({__name:`AppLayout`,setup(o){let f=y(),B=b(),{role:V}=x(),H=[{label:`Dashboard`,path:`/app/home`,icon:`dashboard`,roles:[`USER`,`MERCHANT`,`ADMIN`]},{label:`Products`,path:`/app/catalog`,icon:`products`,roles:[`USER`,`MERCHANT`,`ADMIN`]},{label:`Product Admin`,path:`/app/catalog/manage`,icon:`products-admin`,roles:[`MERCHANT`,`ADMIN`]},{label:`Orders`,path:`/app/orders`,icon:`orders`,roles:[`USER`,`MERCHANT`,`ADMIN`]},{label:`Order Admin`,path:`/app/orders/manage`,icon:`orders-admin`,roles:[`MERCHANT`,`ADMIN`]},{label:`Profile`,path:`/app/profile`,icon:`profile`,roles:[`USER`,`MERCHANT`,`ADMIN`]}],U=p(()=>H.filter(e=>e.roles.includes(V.value))),W=p(()=>String(f.meta.title||`My Shop`)),G=p(()=>{var e,t;return((e=v.user)==null?void 0:e.nickname)||((t=v.user)==null?void 0:t.username)||`Current User`}),K=p(()=>V.value),q=p(()=>(G.value.trim()[0]||`U`).toUpperCase()),J=l(!1),Y=p(()=>{let e=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 120">
    <defs>
      <linearGradient id="g" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" stop-color="#0d2e7d"/>
        <stop offset="100%" stop-color="#3f8cff"/>
      </linearGradient>
    </defs>
    <rect width="120" height="120" rx="36" fill="url(#g)"/>
    <circle cx="60" cy="45" r="18" fill="#ffffff" fill-opacity="0.92"/>
    <path d="M23 100c4-18 20-30 37-30s33 12 37 30" fill="#ffffff" fill-opacity="0.92"/>
    <text x="60" y="112" text-anchor="middle" font-size="18" font-family="Avenir, 'PingFang SC', sans-serif" fill="#f5f8ff">${q.value}</text>
  </svg>`;return`data:image/svg+xml;base64,${window.btoa(unescape(encodeURIComponent(e)))}`}),X=p(()=>{var e;let t=(e=v.user)==null||(e=e.avatarUrl)==null?void 0:e.trim();return t&&!J.value?t:Y.value}),Z={dashboard:`M5 13h6V5H5v8Zm8 6h6V5h-6v14ZM5 19h6v-4H5v4Zm8 0h6v-2h-6v2Z`,products:`M4 7.5 12 4l8 3.5-8 3.5L4 7.5Zm0 3.5 8 3.5 8-3.5M4 14.5 12 18l8-3.5`,"products-admin":`M4 5h16v4H4V5Zm0 5.5h10V20H4v-9.5Zm12 2h4v7.5h-4v-7.5Z`,orders:`M6 5h10l3 3v11H6V5Zm10 0v3h3M9 12h6M9 15h6`,"orders-admin":`M7 4h10v2h3v14H4V6h3V4Zm2 2h6M8 12h8M8 16h5`,profile:`M12 12a4 4 0 1 0-4-4 4 4 0 0 0 4 4Zm0 2c-3.3 0-6 1.8-7 4.5h14c-1-2.7-3.7-4.5-7-4.5Z`};function Q(e){return Z[e]}t(()=>{var e;return(e=v.user)==null?void 0:e.avatarUrl},()=>{J.value=!1});function ne(){J.value=!0}function $(e){return e===`/app/catalog`?f.path===`/app/catalog`:e===`/app/catalog/manage`?f.path===`/app/catalog/manage`:e===`/app/orders`?f.path===`/app/orders`:e===`/app/orders/manage`?f.path===`/app/orders/manage`:f.path===e||f.path.startsWith(`${e}/`)}async function re(){try{await ee()}catch(e){}finally{_(),C.success(`Signed out.`),await B.replace(`/login`)}}return(t,o)=>{let l=g(`router-link`),f=S,p=g(`router-view`);return e(),d(`div`,te,[s(`aside`,w,[o[1]||(o[1]=s(`h1`,{class:`brand`},`My Shop`,-1)),(e(!0),d(a,null,n(U.value,t=>(e(),c(l,{key:t.path,to:t.path,class:u([`nav-link`,{active:$(t.path)}])},{default:i(()=>[s(`span`,T,[(e(),d(`svg`,E,[s(`path`,{d:Q(t.icon)},null,8,D)]))]),s(`span`,O,r(t.label),1)]),_:2},1032,[`to`,`class`]))),128))]),s(`main`,k,[s(`header`,A,[s(`div`,null,[o[2]||(o[2]=s(`div`,{class:`muted`},`Apple-like mobile-first UI`,-1)),s(`h2`,null,r(W.value),1)]),s(`div`,j,[s(`img`,{class:`avatar`,src:X.value,alt:`User avatar`,onError:ne},null,40,M),s(`span`,N,r(K.value),1),s(`span`,P,r(G.value),1),h(f,{round:``,onClick:o[0]||(o[0]=e=>t.$router.push(`/market`))},{default:i(()=>[...o[3]||(o[3]=[m(`访客主页`,-1)])]),_:1}),h(f,{round:``,onClick:re},{default:i(()=>[...o[4]||(o[4]=[m(`Sign Out`,-1)])]),_:1})])]),s(`section`,F,[h(p)])]),s(`nav`,I,[(e(!0),d(a,null,n(U.value,t=>(e(),c(l,{key:t.path,to:t.path,class:u([`tab-item`,{active:$(t.path)}])},{default:i(()=>[s(`span`,L,[(e(),d(`svg`,R,[s(`path`,{d:Q(t.icon)},null,8,z)]))]),s(`span`,null,r(t.label),1)]),_:2},1032,[`to`,`class`]))),128))])])}}}),[[`__scopeId`,`data-v-0f629c61`]]);export{B as default};