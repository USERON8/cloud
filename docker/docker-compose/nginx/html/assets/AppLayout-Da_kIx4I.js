import{t as e}from"./css-gYsclK9r.js";import{F as t,J as n,L as r,Nt as i,X as a,a as o,b as s,d as c,f as l,it as u,jt as d,m as f,t as p,u as m,v as h,y as g,z as _}from"./_plugin-vue_export-helper-CS_DzLMV.js";import{s as v,t as y}from"./session-ki_suUwh.js";import{n as b,r as x,t as S}from"./index-D2O9aft2.js";import{t as C}from"./message-DyMrUQQL.js";import"./http-CgWw7_UJ.js";import{n as w}from"./auth-BUxxQ95I.js";var ee={class:`app-shell`},te={class:`desktop-nav glass-card`},T={class:`nav-icon`,"aria-hidden":`true`},E={viewBox:`0 0 24 24`,fill:`none`},D=[`d`],O={class:`nav-label`},k={class:`main-panel`},A={class:`top-bar glass-card`},j={class:`top-actions`},M=[`src`],N={class:`role-chip`},P={class:`user-chip`},F={class:`content`},I={class:`mobile-tab glass-card`},L={class:`nav-icon`,"aria-hidden":`true`},R={viewBox:`0 0 24 24`,fill:`none`},z=[`d`],B=p(s({__name:`AppLayout`,setup(s){let p=b(),B=x(),{role:V}=S(),H=[{label:`Dashboard`,path:`/app/home`,icon:`dashboard`,roles:[`USER`,`MERCHANT`,`ADMIN`]},{label:`Products`,path:`/app/catalog`,icon:`products`,roles:[`USER`,`MERCHANT`,`ADMIN`]},{label:`Product Admin`,path:`/app/catalog/manage`,icon:`products-admin`,roles:[`MERCHANT`,`ADMIN`]},{label:`Orders`,path:`/app/orders`,icon:`orders`,roles:[`USER`,`MERCHANT`,`ADMIN`]},{label:`Order Admin`,path:`/app/orders/manage`,icon:`orders-admin`,roles:[`MERCHANT`,`ADMIN`]},{label:`Profile`,path:`/app/profile`,icon:`profile`,roles:[`USER`,`MERCHANT`,`ADMIN`]}],U=m(()=>H.filter(e=>e.roles.includes(V.value))),W=m(()=>String(p.meta.title||`My Shop`)),G=m(()=>{var e,t;return((e=v.user)==null?void 0:e.nickname)||((t=v.user)==null?void 0:t.username)||`Current User`}),K=m(()=>V.value),q=m(()=>(G.value.trim()[0]||`U`).toUpperCase()),J=u(!1),Y=m(()=>{let e=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 120">
    <defs>
      <linearGradient id="g" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" stop-color="#0d2e7d"/>
        <stop offset="100%" stop-color="#3f8cff"/>
      </linearGradient>
    </defs>
    <rect width="120" height="120" rx="36" fill="url(#g)"/>
    <circle cx="60" cy="45" r="18" fill="#ffffff" fill-opacity="0.92"/>
    <path d="M23 100c4-18 20-30 37-30s33 12 37 30" fill="#ffffff" fill-opacity="0.92"/>
    <text x="60" y="112" text-anchor="middle" font-size="18" font-family="Avenir, 'PingFang SC', sans-serif" fill="#f5f8ff">${q.value}</text>
  </svg>`;return`data:image/svg+xml;base64,${window.btoa(unescape(encodeURIComponent(e)))}`}),X=m(()=>{var e;let t=(e=v.user)==null||(e=e.avatarUrl)==null?void 0:e.trim();return t&&!J.value?t:Y.value}),Z={dashboard:`M5 13h6V5H5v8Zm8 6h6V5h-6v14ZM5 19h6v-4H5v4Zm8 0h6v-2h-6v2Z`,products:`M4 7.5 12 4l8 3.5-8 3.5L4 7.5Zm0 3.5 8 3.5 8-3.5M4 14.5 12 18l8-3.5`,"products-admin":`M4 5h16v4H4V5Zm0 5.5h10V20H4v-9.5Zm12 2h4v7.5h-4v-7.5Z`,orders:`M6 5h10l3 3v11H6V5Zm10 0v3h3M9 12h6M9 15h6`,"orders-admin":`M7 4h10v2h3v14H4V6h3V4Zm2 2h6M8 12h8M8 16h5`,profile:`M12 12a4 4 0 1 0-4-4 4 4 0 0 0 4 4Zm0 2c-3.3 0-6 1.8-7 4.5h14c-1-2.7-3.7-4.5-7-4.5Z`};function Q(e){return Z[e]}n(()=>{var e;return(e=v.user)==null?void 0:e.avatarUrl},()=>{J.value=!1});function ne(){J.value=!0}function $(e){return e===`/app/catalog`?p.path===`/app/catalog`:e===`/app/catalog/manage`?p.path===`/app/catalog/manage`:e===`/app/orders`?p.path===`/app/orders`:e===`/app/orders/manage`?p.path===`/app/orders/manage`:p.path===e||p.path.startsWith(`${e}/`)}async function re(){try{await w()}catch(e){}finally{y(),C.success(`Signed out.`),await B.replace(`/login`)}}return(n,s)=>{let u=_(`router-link`),p=e,m=_(`router-view`);return t(),f(`div`,ee,[c(`aside`,te,[s[1]||(s[1]=c(`h1`,{class:`brand`},`My Shop`,-1)),(t(!0),f(o,null,r(U.value,e=>(t(),l(u,{key:e.path,to:e.path,class:d([`nav-link`,{active:$(e.path)}])},{default:a(()=>[c(`span`,T,[(t(),f(`svg`,E,[c(`path`,{d:Q(e.icon)},null,8,D)]))]),c(`span`,O,i(e.label),1)]),_:2},1032,[`to`,`class`]))),128))]),c(`main`,k,[c(`header`,A,[c(`div`,null,[s[2]||(s[2]=c(`div`,{class:`muted`},`Apple-like mobile-first UI`,-1)),c(`h2`,null,i(W.value),1)]),c(`div`,j,[c(`img`,{class:`avatar`,src:X.value,alt:`User avatar`,onError:ne},null,40,M),c(`span`,N,i(K.value),1),c(`span`,P,i(G.value),1),g(p,{round:``,onClick:s[0]||(s[0]=e=>n.$router.push(`/market`))},{default:a(()=>[...s[3]||(s[3]=[h(`访客主页`,-1)])]),_:1}),g(p,{round:``,onClick:re},{default:a(()=>[...s[4]||(s[4]=[h(`Sign Out`,-1)])]),_:1})])]),c(`section`,F,[g(m)])]),c(`nav`,I,[(t(!0),f(o,null,r(U.value,e=>(t(),l(u,{key:e.path,to:e.path,class:d([`tab-item`,{active:$(e.path)}])},{default:a(()=>[c(`span`,L,[(t(),f(`svg`,R,[c(`path`,{d:Q(e.icon)},null,8,z)]))]),c(`span`,null,i(e.label),1)]),_:2},1032,[`to`,`class`]))),128))])])}}}),[[`__scopeId`,`data-v-0f629c61`]]);export{B as default};